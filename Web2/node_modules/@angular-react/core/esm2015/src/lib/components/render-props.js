import { TemplateRef, ComponentRef } from '@angular/core';
import { createTemplateRenderer, createComponentRenderer, createHtmlRenderer, isRenderPropContext, } from '../renderer/renderprop-helpers';
function isRenderComponentOptions(x) {
    if (typeof x !== 'object') {
        return false;
    }
    const maybeRenderComponentOptions = x;
    return (maybeRenderComponentOptions.componentType != null &&
        maybeRenderComponentOptions.factoryResolver != null &&
        maybeRenderComponentOptions.injector != null);
}
function isRenderPropOptions(x) {
    if (typeof x !== 'object') {
        return false;
    }
    const maybeRenderPropOptions = x;
    return maybeRenderPropOptions.getProps && typeof maybeRenderPropOptions.getProps === 'function';
}
export function createInputJsxRenderer(input, ngZone, additionalProps) {
    if (input instanceof TemplateRef) {
        const templateRenderer = createTemplateRenderer(input, ngZone, additionalProps);
        return (context) => templateRenderer.render(context);
    }
    if (input instanceof ComponentRef) {
        const componentRenderer = createComponentRenderer(input, additionalProps);
        return (context) => componentRenderer.render(context);
    }
    if (input instanceof Function) {
        const htmlRenderer = createHtmlRenderer(input, additionalProps);
        return (context) => htmlRenderer.render(context);
    }
    if (isRenderComponentOptions(input)) {
        const { componentType, factoryResolver, injector } = input;
        const componentFactory = factoryResolver.resolveComponentFactory(componentType);
        const componentRef = componentFactory.create(injector);
        // Call the function again with the created ComponentRef<TContext>
        return createInputJsxRenderer(componentRef, ngZone, additionalProps);
    }
}
export function createRenderPropHandler(renderInputValue, ngZone, options) {
    if (isRenderPropContext(renderInputValue)) {
        return renderInputValue.render;
    }
    if (isRenderPropOptions(renderInputValue)) {
        return (props, defaultRender) => {
            return typeof defaultRender === 'function' ? defaultRender(renderInputValue.getProps(props)) : null;
        };
    }
    const renderer = (options && options.jsxRenderer) ||
        createInputJsxRenderer(renderInputValue, ngZone, options && options.additionalProps);
    return (props, defaultRender) => {
        if (!renderInputValue) {
            return typeof defaultRender === 'function' ? defaultRender(props) : null;
        }
        return renderer(props);
    };
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmVuZGVyLXByb3BzLmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGFuZ3VsYXItcmVhY3QvY29yZS8iLCJzb3VyY2VzIjpbInNyYy9saWIvY29tcG9uZW50cy9yZW5kZXItcHJvcHMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUE0QyxXQUFXLEVBQUUsWUFBWSxFQUFVLE1BQU0sZUFBZSxDQUFDO0FBQzVHLE9BQU8sRUFFTCxzQkFBc0IsRUFDdEIsdUJBQXVCLEVBQ3ZCLGtCQUFrQixFQUNsQixtQkFBbUIsR0FDcEIsTUFBTSxnQ0FBZ0MsQ0FBQztBQWN4QyxTQUFTLHdCQUF3QixDQUEwQixDQUFVO0lBQ25FLElBQUksT0FBTyxDQUFDLEtBQUssUUFBUSxFQUFFO1FBQ3pCLE9BQU8sS0FBSyxDQUFDO0tBQ2Q7SUFFRCxNQUFNLDJCQUEyQixHQUFHLENBQXFDLENBQUM7SUFDMUUsT0FBTyxDQUNMLDJCQUEyQixDQUFDLGFBQWEsSUFBSSxJQUFJO1FBQ2pELDJCQUEyQixDQUFDLGVBQWUsSUFBSSxJQUFJO1FBQ25ELDJCQUEyQixDQUFDLFFBQVEsSUFBSSxJQUFJLENBQzdDLENBQUM7QUFDSixDQUFDO0FBU0QsU0FBUyxtQkFBbUIsQ0FBMEIsQ0FBVTtJQUM5RCxJQUFJLE9BQU8sQ0FBQyxLQUFLLFFBQVEsRUFBRTtRQUN6QixPQUFPLEtBQUssQ0FBQztLQUNkO0lBRUQsTUFBTSxzQkFBc0IsR0FBRyxDQUFnQyxDQUFDO0lBQ2hFLE9BQU8sc0JBQXNCLENBQUMsUUFBUSxJQUFJLE9BQU8sc0JBQXNCLENBQUMsUUFBUSxLQUFLLFVBQVUsQ0FBQztBQUNsRyxDQUFDO0FBYUQsTUFBTSxVQUFVLHNCQUFzQixDQUNwQyxLQUFxQyxFQUNyQyxNQUFjLEVBQ2QsZUFBbUM7SUFFbkMsSUFBSSxLQUFLLFlBQVksV0FBVyxFQUFFO1FBQ2hDLE1BQU0sZ0JBQWdCLEdBQUcsc0JBQXNCLENBQUMsS0FBSyxFQUFFLE1BQU0sRUFBRSxlQUFlLENBQUMsQ0FBQztRQUNoRixPQUFPLENBQUMsT0FBaUIsRUFBRSxFQUFFLENBQUMsZ0JBQWdCLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDO0tBQ2hFO0lBRUQsSUFBSSxLQUFLLFlBQVksWUFBWSxFQUFFO1FBQ2pDLE1BQU0saUJBQWlCLEdBQUcsdUJBQXVCLENBQUMsS0FBSyxFQUFFLGVBQWUsQ0FBQyxDQUFDO1FBQzFFLE9BQU8sQ0FBQyxPQUFpQixFQUFFLEVBQUUsQ0FBQyxpQkFBaUIsQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUM7S0FDakU7SUFFRCxJQUFJLEtBQUssWUFBWSxRQUFRLEVBQUU7UUFDN0IsTUFBTSxZQUFZLEdBQUcsa0JBQWtCLENBQUMsS0FBSyxFQUFFLGVBQWUsQ0FBQyxDQUFDO1FBQ2hFLE9BQU8sQ0FBQyxPQUFpQixFQUFFLEVBQUUsQ0FBQyxZQUFZLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDO0tBQzVEO0lBRUQsSUFBSSx3QkFBd0IsQ0FBQyxLQUFLLENBQUMsRUFBRTtRQUNuQyxNQUFNLEVBQUUsYUFBYSxFQUFFLGVBQWUsRUFBRSxRQUFRLEVBQUUsR0FBRyxLQUFLLENBQUM7UUFDM0QsTUFBTSxnQkFBZ0IsR0FBRyxlQUFlLENBQUMsdUJBQXVCLENBQUMsYUFBYSxDQUFDLENBQUM7UUFDaEYsTUFBTSxZQUFZLEdBQUcsZ0JBQWdCLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxDQUFDO1FBRXZELGtFQUFrRTtRQUNsRSxPQUFPLHNCQUFzQixDQUFDLFlBQVksRUFBRSxNQUFNLEVBQUUsZUFBZSxDQUFDLENBQUM7S0FDdEU7QUFDSCxDQUFDO0FBRUQsTUFBTSxVQUFVLHVCQUF1QixDQUNyQyxnQkFBOEMsRUFDOUMsTUFBYyxFQUNkLE9BR0M7SUFFRCxJQUFJLG1CQUFtQixDQUFDLGdCQUFnQixDQUFDLEVBQUU7UUFDekMsT0FBTyxnQkFBZ0IsQ0FBQyxNQUFNLENBQUM7S0FDaEM7SUFFRCxJQUFJLG1CQUFtQixDQUFDLGdCQUFnQixDQUFDLEVBQUU7UUFDekMsT0FBTyxDQUFDLEtBQWMsRUFBRSxhQUFxQyxFQUFFLEVBQUU7WUFDL0QsT0FBTyxPQUFPLGFBQWEsS0FBSyxVQUFVLENBQUMsQ0FBQyxDQUFDLGFBQWEsQ0FBQyxnQkFBZ0IsQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDO1FBQ3RHLENBQUMsQ0FBQztLQUNIO0lBRUQsTUFBTSxRQUFRLEdBQ1osQ0FBQyxPQUFPLElBQUksT0FBTyxDQUFDLFdBQVcsQ0FBQztRQUNoQyxzQkFBc0IsQ0FBQyxnQkFBZ0IsRUFBRSxNQUFNLEVBQUUsT0FBTyxJQUFJLE9BQU8sQ0FBQyxlQUFlLENBQUMsQ0FBQztJQUV2RixPQUFPLENBQUMsS0FBYyxFQUFFLGFBQXFDLEVBQUUsRUFBRTtRQUMvRCxJQUFJLENBQUMsZ0JBQWdCLEVBQUU7WUFDckIsT0FBTyxPQUFPLGFBQWEsS0FBSyxVQUFVLENBQUMsQ0FBQyxDQUFDLGFBQWEsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDO1NBQzFFO1FBRUQsT0FBTyxRQUFRLENBQUMsS0FBSyxDQUFDLENBQUM7SUFDekIsQ0FBQyxDQUFDO0FBQ0osQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbXBvbmVudEZhY3RvcnlSZXNvbHZlciwgVHlwZSwgSW5qZWN0b3IsIFRlbXBsYXRlUmVmLCBDb21wb25lbnRSZWYsIE5nWm9uZSB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQge1xyXG4gIFJlbmRlclByb3BDb250ZXh0LFxyXG4gIGNyZWF0ZVRlbXBsYXRlUmVuZGVyZXIsXHJcbiAgY3JlYXRlQ29tcG9uZW50UmVuZGVyZXIsXHJcbiAgY3JlYXRlSHRtbFJlbmRlcmVyLFxyXG4gIGlzUmVuZGVyUHJvcENvbnRleHQsXHJcbn0gZnJvbSAnLi4vcmVuZGVyZXIvcmVuZGVycHJvcC1oZWxwZXJzJztcclxuaW1wb3J0IHsgUmVhY3RDb250ZW50UHJvcHMgfSBmcm9tICcuLi9yZW5kZXJlci9yZWFjdC1jb250ZW50JztcclxuXHJcbmV4cG9ydCB0eXBlIEpzeFJlbmRlckZ1bmM8VENvbnRleHQ+ID0gKGNvbnRleHQ6IFRDb250ZXh0KSA9PiBKU1guRWxlbWVudDtcclxuXHJcbi8qKlxyXG4gKiBSZW5kZXIgcHJvcHMgb3B0aW9ucyBmb3IgY3JlYXRpbmcgJiByZW5kZXJpbmcgYSBjb21wb25lbnQuXHJcbiAqL1xyXG5leHBvcnQgaW50ZXJmYWNlIFJlbmRlckNvbXBvbmVudE9wdGlvbnM8VENvbnRleHQgZXh0ZW5kcyBvYmplY3Q+IHtcclxuICByZWFkb25seSBjb21wb25lbnRUeXBlOiBUeXBlPFRDb250ZXh0PjtcclxuICByZWFkb25seSBmYWN0b3J5UmVzb2x2ZXI6IENvbXBvbmVudEZhY3RvcnlSZXNvbHZlcjtcclxuICByZWFkb25seSBpbmplY3RvcjogSW5qZWN0b3I7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGlzUmVuZGVyQ29tcG9uZW50T3B0aW9uczxUQ29udGV4dCBleHRlbmRzIG9iamVjdD4oeDogdW5rbm93bik6IHggaXMgUmVuZGVyQ29tcG9uZW50T3B0aW9uczxUQ29udGV4dD4ge1xyXG4gIGlmICh0eXBlb2YgeCAhPT0gJ29iamVjdCcpIHtcclxuICAgIHJldHVybiBmYWxzZTtcclxuICB9XHJcblxyXG4gIGNvbnN0IG1heWJlUmVuZGVyQ29tcG9uZW50T3B0aW9ucyA9IHggYXMgUmVuZGVyQ29tcG9uZW50T3B0aW9uczxUQ29udGV4dD47XHJcbiAgcmV0dXJuIChcclxuICAgIG1heWJlUmVuZGVyQ29tcG9uZW50T3B0aW9ucy5jb21wb25lbnRUeXBlICE9IG51bGwgJiZcclxuICAgIG1heWJlUmVuZGVyQ29tcG9uZW50T3B0aW9ucy5mYWN0b3J5UmVzb2x2ZXIgIT0gbnVsbCAmJlxyXG4gICAgbWF5YmVSZW5kZXJDb21wb25lbnRPcHRpb25zLmluamVjdG9yICE9IG51bGxcclxuICApO1xyXG59XHJcblxyXG4vKipcclxuICogQWxsb3cgaW50ZXJjZXB0aW5nIGFuZCBtb2RpZnlpbmcgdGhlIGRlZmF1bHQgcHJvcHMsIHdoaWNoIGFyZSB0aGVuIHVzZWQgYnkgdGhlIGRlZmF1bHQgcmVuZGVyZXIuXHJcbiAqL1xyXG5leHBvcnQgaW50ZXJmYWNlIFJlbmRlclByb3BPcHRpb25zPFRDb250ZXh0IGV4dGVuZHMgb2JqZWN0PiB7XHJcbiAgcmVhZG9ubHkgZ2V0UHJvcHM6IChkZWZhdWx0UHJvcHM/OiBUQ29udGV4dCkgPT4gVENvbnRleHQ7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGlzUmVuZGVyUHJvcE9wdGlvbnM8VENvbnRleHQgZXh0ZW5kcyBvYmplY3Q+KHg6IHVua25vd24pOiB4IGlzIFJlbmRlclByb3BPcHRpb25zPFRDb250ZXh0PiB7XHJcbiAgaWYgKHR5cGVvZiB4ICE9PSAnb2JqZWN0Jykge1xyXG4gICAgcmV0dXJuIGZhbHNlO1xyXG4gIH1cclxuXHJcbiAgY29uc3QgbWF5YmVSZW5kZXJQcm9wT3B0aW9ucyA9IHggYXMgUmVuZGVyUHJvcE9wdGlvbnM8VENvbnRleHQ+O1xyXG4gIHJldHVybiBtYXliZVJlbmRlclByb3BPcHRpb25zLmdldFByb3BzICYmIHR5cGVvZiBtYXliZVJlbmRlclByb3BPcHRpb25zLmdldFByb3BzID09PSAnZnVuY3Rpb24nO1xyXG59XHJcblxyXG4vKipcclxuICogVmFyaW91cyBvcHRpb25zIGZvciBwYXNzaW5nIHJlbmRlcmVycyBhcyByZW5kZXIgcHJvcHMuXHJcbiAqL1xyXG5leHBvcnQgdHlwZSBJbnB1dFJlbmRlcmVyT3B0aW9uczxUQ29udGV4dCBleHRlbmRzIG9iamVjdD4gPVxyXG4gIHwgVGVtcGxhdGVSZWY8VENvbnRleHQ+XHJcbiAgfCAoKGNvbnRleHQ6IFRDb250ZXh0KSA9PiBIVE1MRWxlbWVudClcclxuICB8IENvbXBvbmVudFJlZjxUQ29udGV4dD5cclxuICB8IFJlbmRlckNvbXBvbmVudE9wdGlvbnM8VENvbnRleHQ+XHJcbiAgfCBSZW5kZXJQcm9wQ29udGV4dDxUQ29udGV4dD5cclxuICB8IFJlbmRlclByb3BPcHRpb25zPFRDb250ZXh0PjtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVJbnB1dEpzeFJlbmRlcmVyPFRDb250ZXh0IGV4dGVuZHMgb2JqZWN0PihcclxuICBpbnB1dDogSW5wdXRSZW5kZXJlck9wdGlvbnM8VENvbnRleHQ+LFxyXG4gIG5nWm9uZTogTmdab25lLFxyXG4gIGFkZGl0aW9uYWxQcm9wcz86IFJlYWN0Q29udGVudFByb3BzXHJcbik6IEpzeFJlbmRlckZ1bmM8VENvbnRleHQ+IHwgdW5kZWZpbmVkIHtcclxuICBpZiAoaW5wdXQgaW5zdGFuY2VvZiBUZW1wbGF0ZVJlZikge1xyXG4gICAgY29uc3QgdGVtcGxhdGVSZW5kZXJlciA9IGNyZWF0ZVRlbXBsYXRlUmVuZGVyZXIoaW5wdXQsIG5nWm9uZSwgYWRkaXRpb25hbFByb3BzKTtcclxuICAgIHJldHVybiAoY29udGV4dDogVENvbnRleHQpID0+IHRlbXBsYXRlUmVuZGVyZXIucmVuZGVyKGNvbnRleHQpO1xyXG4gIH1cclxuXHJcbiAgaWYgKGlucHV0IGluc3RhbmNlb2YgQ29tcG9uZW50UmVmKSB7XHJcbiAgICBjb25zdCBjb21wb25lbnRSZW5kZXJlciA9IGNyZWF0ZUNvbXBvbmVudFJlbmRlcmVyKGlucHV0LCBhZGRpdGlvbmFsUHJvcHMpO1xyXG4gICAgcmV0dXJuIChjb250ZXh0OiBUQ29udGV4dCkgPT4gY29tcG9uZW50UmVuZGVyZXIucmVuZGVyKGNvbnRleHQpO1xyXG4gIH1cclxuXHJcbiAgaWYgKGlucHV0IGluc3RhbmNlb2YgRnVuY3Rpb24pIHtcclxuICAgIGNvbnN0IGh0bWxSZW5kZXJlciA9IGNyZWF0ZUh0bWxSZW5kZXJlcihpbnB1dCwgYWRkaXRpb25hbFByb3BzKTtcclxuICAgIHJldHVybiAoY29udGV4dDogVENvbnRleHQpID0+IGh0bWxSZW5kZXJlci5yZW5kZXIoY29udGV4dCk7XHJcbiAgfVxyXG5cclxuICBpZiAoaXNSZW5kZXJDb21wb25lbnRPcHRpb25zKGlucHV0KSkge1xyXG4gICAgY29uc3QgeyBjb21wb25lbnRUeXBlLCBmYWN0b3J5UmVzb2x2ZXIsIGluamVjdG9yIH0gPSBpbnB1dDtcclxuICAgIGNvbnN0IGNvbXBvbmVudEZhY3RvcnkgPSBmYWN0b3J5UmVzb2x2ZXIucmVzb2x2ZUNvbXBvbmVudEZhY3RvcnkoY29tcG9uZW50VHlwZSk7XHJcbiAgICBjb25zdCBjb21wb25lbnRSZWYgPSBjb21wb25lbnRGYWN0b3J5LmNyZWF0ZShpbmplY3Rvcik7XHJcblxyXG4gICAgLy8gQ2FsbCB0aGUgZnVuY3Rpb24gYWdhaW4gd2l0aCB0aGUgY3JlYXRlZCBDb21wb25lbnRSZWY8VENvbnRleHQ+XHJcbiAgICByZXR1cm4gY3JlYXRlSW5wdXRKc3hSZW5kZXJlcihjb21wb25lbnRSZWYsIG5nWm9uZSwgYWRkaXRpb25hbFByb3BzKTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVSZW5kZXJQcm9wSGFuZGxlcjxUUHJvcHMgZXh0ZW5kcyBvYmplY3Q+KFxyXG4gIHJlbmRlcklucHV0VmFsdWU6IElucHV0UmVuZGVyZXJPcHRpb25zPFRQcm9wcz4sXHJcbiAgbmdab25lOiBOZ1pvbmUsXHJcbiAgb3B0aW9ucz86IHtcclxuICAgIGpzeFJlbmRlcmVyPzogSnN4UmVuZGVyRnVuYzxUUHJvcHM+O1xyXG4gICAgYWRkaXRpb25hbFByb3BzPzogUmVhY3RDb250ZW50UHJvcHM7XHJcbiAgfVxyXG4pOiAocHJvcHM/OiBUUHJvcHMsIGRlZmF1bHRSZW5kZXI/OiBKc3hSZW5kZXJGdW5jPFRQcm9wcz4pID0+IEpTWC5FbGVtZW50IHwgbnVsbCB7XHJcbiAgaWYgKGlzUmVuZGVyUHJvcENvbnRleHQocmVuZGVySW5wdXRWYWx1ZSkpIHtcclxuICAgIHJldHVybiByZW5kZXJJbnB1dFZhbHVlLnJlbmRlcjtcclxuICB9XHJcblxyXG4gIGlmIChpc1JlbmRlclByb3BPcHRpb25zKHJlbmRlcklucHV0VmFsdWUpKSB7XHJcbiAgICByZXR1cm4gKHByb3BzPzogVFByb3BzLCBkZWZhdWx0UmVuZGVyPzogSnN4UmVuZGVyRnVuYzxUUHJvcHM+KSA9PiB7XHJcbiAgICAgIHJldHVybiB0eXBlb2YgZGVmYXVsdFJlbmRlciA9PT0gJ2Z1bmN0aW9uJyA/IGRlZmF1bHRSZW5kZXIocmVuZGVySW5wdXRWYWx1ZS5nZXRQcm9wcyhwcm9wcykpIDogbnVsbDtcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICBjb25zdCByZW5kZXJlciA9XHJcbiAgICAob3B0aW9ucyAmJiBvcHRpb25zLmpzeFJlbmRlcmVyKSB8fFxyXG4gICAgY3JlYXRlSW5wdXRKc3hSZW5kZXJlcihyZW5kZXJJbnB1dFZhbHVlLCBuZ1pvbmUsIG9wdGlvbnMgJiYgb3B0aW9ucy5hZGRpdGlvbmFsUHJvcHMpO1xyXG5cclxuICByZXR1cm4gKHByb3BzPzogVFByb3BzLCBkZWZhdWx0UmVuZGVyPzogSnN4UmVuZGVyRnVuYzxUUHJvcHM+KSA9PiB7XHJcbiAgICBpZiAoIXJlbmRlcklucHV0VmFsdWUpIHtcclxuICAgICAgcmV0dXJuIHR5cGVvZiBkZWZhdWx0UmVuZGVyID09PSAnZnVuY3Rpb24nID8gZGVmYXVsdFJlbmRlcihwcm9wcykgOiBudWxsO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiByZW5kZXJlcihwcm9wcyk7XHJcbiAgfTtcclxufVxyXG4iXX0=